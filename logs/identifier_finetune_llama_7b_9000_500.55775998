Training model with params:
base_model: meta-llama/Llama-2-7b-hf
data_path: /home/zt264/rds/hpc-work/Thesis/MLMI_Thesis/identifier_jsonls/train.jsonl
output_dir: /rds/project/rds-xyBFuSj0hm0/shared_drive/zt264/identifier_checkpoints/
batch_size: 4
micro_batch_size: 1
train_steps: 9000
learning_rate: 1e-05
cutoff_len: 2048
val_set_path: /home/zt264/rds/hpc-work/Thesis/MLMI_Thesis/identifier_jsonls/val.jsonl
use_lora: False
lora_r: 8
lora_alpha: 16
lora_dropout: 0.05
lora_target_modules: ['q_proj', 'v_proj']
train_on_inputs: True
add_eos_token: False
group_by_length: False
wandb_project: Identifier_Finetuning
wandb_run_name: 
wandb_watch: 
wandb_log_model: 
resume_from_checkpoint: False
prompt template: llama2_backdoor_identifier
use_wandb: True
seed: 42
eval_after_steps: 500

# model params: 6738.42M
Setting process seed: 42
Initialization w&b...
Evaluating model...
Error: 
Error: 
Error: 
Accuracy: 0.498, Clean accuracy: 0.996, Poisoned accuracy: 0.0
Saving model checkpoint...
Model state dict saved: /rds/project/rds-xyBFuSj0hm0/shared_drive/zt264/identifier_checkpoints/model_9000_steps
Evaluating model...
Error: 
Error: 
Accuracy: 0.5, Clean accuracy: 0.0, Poisoned accuracy: 1.0
Saving model checkpoint...
Model state dict saved: /rds/project/rds-xyBFuSj0hm0/shared_drive/zt264/identifier_checkpoints/model_9000_steps
Evaluating model...
Error: 
Accuracy: 0.789, Clean accuracy: 0.91, Poisoned accuracy: 0.668
Saving model checkpoint...
Model state dict saved: /rds/project/rds-xyBFuSj0hm0/shared_drive/zt264/identifier_checkpoints/model_9000_steps
Evaluating model...
Accuracy: 0.85, Clean accuracy: 1.0, Poisoned accuracy: 0.7
Saving model checkpoint...
Model state dict saved: /rds/project/rds-xyBFuSj0hm0/shared_drive/zt264/identifier_checkpoints/model_9000_steps
Evaluating model...
Accuracy: 0.918, Clean accuracy: 0.996, Poisoned accuracy: 0.84
Saving model checkpoint...
Model state dict saved: /rds/project/rds-xyBFuSj0hm0/shared_drive/zt264/identifier_checkpoints/model_9000_steps
Evaluating model...
Accuracy: 0.839, Clean accuracy: 1.0, Poisoned accuracy: 0.678
Evaluating model...
Accuracy: 0.867, Clean accuracy: 1.0, Poisoned accuracy: 0.734
Evaluating model...
Accuracy: 0.859, Clean accuracy: 1.0, Poisoned accuracy: 0.718
Evaluating model...
Accuracy: 0.675, Clean accuracy: 1.0, Poisoned accuracy: 0.35
Evaluating model...
Accuracy: 0.888, Clean accuracy: 1.0, Poisoned accuracy: 0.776
Evaluating model...
Accuracy: 0.879, Clean accuracy: 1.0, Poisoned accuracy: 0.758
Evaluating model...
Error: AT
Error: AT
Error: AT
Error: AT
Error: AT
Error: AT
Error: AT
Error: AT
Accuracy: 0.928, Clean accuracy: 0.992, Poisoned accuracy: 0.864
Saving model checkpoint...
Model state dict saved: /rds/project/rds-xyBFuSj0hm0/shared_drive/zt264/identifier_checkpoints/model_9000_steps
Evaluating model...
Accuracy: 0.884, Clean accuracy: 1.0, Poisoned accuracy: 0.768
Evaluating model...
Accuracy: 0.878, Clean accuracy: 1.0, Poisoned accuracy: 0.756
